<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:pretty="http://ocpsoft.com/prettyfaces" >
	

<body>

	<f:metadata>
		<f:viewParam name="mailinglist"
			value="#{contentResponse.viewMailinglist}" />
	<f:event type="postAddToView"
			listener="#{contentResponse.getLatest(10)}" /> 
	</f:metadata>
	

	<ui:composition template="/templates/mainTemplate.xhtml">
		<ui:define name="leftcolumnMenu">
			
		</ui:define>
		<ui:define name="content">
		<center><h:outputLabel value="#{mailinglist}" /></center>
			<h:form id="form">
				<rich:tabPanel style="border:none" switchType="server"
					headerAlignment="left"  itemChangeListener="#{panelChangeListener.processItemChange}">
					<rich:tab style="" name="latest" header="Latest" >
					</rich:tab>
					<rich:tab style="" name="topics" header="Topics"  >
					</rich:tab>

					<rich:tab style="" name="search" header="Search">
						<center>
							Search
							<h:inputText value="#{panelChangeListener.searchString}" />
							in
							<h:selectOneMenu value="#{panelChangeListener.searchOption}">
								<f:selectItem id="content" name="content" itemLabel="Content" itemValue="content" />
								<f:selectItem id="author" itemLabel="Author" itemValue="author" />
								<f:selectItem id="mailinglist" itemLabel="Mailing list" itemValue="mailinglist" />
							</h:selectOneMenu>
							<h:commandButton value="search" type="search" action="#{panelChangeListener.search}" />
						</center>
					</rich:tab>

				</rich:tabPanel>
			</h:form>

			<div>
				<ul>
					<ui:repeat value="#{contentResponse.emails}" var="email">
						<div style="border-bottom: solid #E8E8E8;" id="email-list">
							<b>ID: </b>
							<h:outputLabel value="#{email.id}" />
							<br /> <b>From: </b>
							<h:outputLabel value="#{email.from}" /> <br/>
							<b>Date: </b>
				            <h:outputLabel render="#{email.dateInString}" value="#{email.dateInString}" />
							<br /> <b>Subject: </b>
							<h:outputLabel value="#{email.subject}" />
							<br /> <br />
							<h:form>
								<br />
								<b>Content: </b>
								<h:outputLabel
									value="#{email.mainContent[0].getShorterContent(100)}" />...
							    <pretty:link mappingId="email">
							        <f:param value="#{mailinglist}" />
									<f:param value="#{email.id}" />
									more
								</pretty:link>
					</h:form>
							<br />
							<ui:repeat value="#{email.replies}" var="reply">
								<h:form>
									<b>Reply: </b>
									<pretty:link mappingId="email">
							        <f:param value="#{mailinglist}" />
									<f:param value="#{reply}" />
									<h:outputLabel value="#{reply}" />
								</pretty:link>

									<br />
								</h:form>
							</ui:repeat>

							<br />
							<h:outputLabel value="Thread root: #{email.root}" />
							<br />
						</div>
					</ui:repeat>
				</ul>
			</div>




		</ui:define>
	</ui:composition>
</body>
</html>
